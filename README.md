# Yagodka — CLI клиент (TUI)

Терминальный клиент Yagodka — это curses‑интерфейс для работы с сервером Yagodka по TCP (NDJSON протокол).
Подходит для Linux/macOS (обычный терминал/SSH), поддерживает хоткеи и «терминальный вайб».

## Возможности

- Сообщения: личные (DM), чаты (groups), доски (boards).
- История/поиск (в рамках того, что отдаёт сервер).
- Отправка файлов (offer/upload/download через серверный протокол).
- Профиль: display name и @handle.
- Контакты/онлайн‑статусы, mute/block (если включено на сервере).
- Авто‑обновление клиента из `UPDATE_URL` (подпись проверяется по `UPDATE_PUBKEY`).

## Где запускать

- **Linux/macOS**: локально в терминале или по SSH (рекомендуется).
- **macOS app bundle**: клиент умеет выбирать writable‑директории (Application Support), чтобы работать даже если папка приложения read‑only.
- **Windows**: не является целевой платформой (curses/tty поведение отличается).

## Быстрый старт

Требования:
- Python 3
- Доступ до сервера (`host:port`), по умолчанию `yagodka.org:7777`

Запуск:

```bash
cd client-cli
make run SERVER=yagodka.org:7777 UPDATE_URL=https://yagodka.org:17778
```

Для подробных логов:

```bash
make run-debug SERVER=yagodka.org:7777 UPDATE_URL=https://yagodka.org:17778
```

## Конфигурация и данные

Клиент хранит локальные данные в директориях:

- `config/` — конфигурация (создаётся/обновляется при запуске).
- `var/` — runtime‑данные (логи, история ввода, кэш обновлений и т.д.).

Пути можно переопределить переменными:

- `CLIENT_CONFIG_DIR` — куда писать конфиг.
- `CLIENT_VAR_DIR` — куда писать runtime‑данные.

## Обновления

Клиент может скачивать обновление из `UPDATE_URL` и проверять подпись с помощью `UPDATE_PUBKEY`.
Ручное обновление:

```bash
make update UPDATE_URL=https://yagodka.org:17778
```

## Тесты

Тут есть лёгкие unit‑тесты для чистых функций (без curses):

```bash
make test
```

## Важно

- Не коммитьте `config/client_config.json` и содержимое `var/` — это локальное состояние.

